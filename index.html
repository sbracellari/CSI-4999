<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
	<title>Buddy Bot - A Programmer's Best Buddy.</title>
	<link rel="stylesheet" media="all" href="./chat-bubble/component/styles/setup.css">
	<link rel="stylesheet" media="all" href="./chat-bubble/component/styles/says.css">
	<link rel="stylesheet" media="all" href="./chat-bubble/component/styles/reply.css">
	<link rel="stylesheet" media="all" href="./chat-bubble/component/styles/typing.css">
	<link rel="stylesheet" media="all" href="./chat-bubble/component/styles/input.css">
	<style>
	  body {
      background: #adebeb;
    }
    .element-style{
      padding-bottom: 100px;
      padding-top: 100px;
    }
    .bubble-wrap, .bubble-container{
      background: #d6f5f5;
    }
	  .bubble-container {
      height: 100vh;
	  }
	  .bubble-container .input-wrap textarea {
		  margin: 0;
		  width: calc(100% - 30px);
    }
	</style>
</head>
<body>
<h1> 
    <img src="https://wallpaperaccess.com/full/557726.png" alt="buddy bot image"style="width:754px;height:378px;"> 
</h1>

<!----ASHLEY ADD AN HTML IMAGE MAP TO THE TIP OF BUDDY BOT to turn him 'evil' !!-->
<!---- the script -->
<script src="./chat-bubble/component/Bubbles.js"></script>

<!-- container element for chat window -->
<div id="buddy-bot"></div>

<!-- import the JavaScript file -->
<script src="./chat-bubble/component/Bubbles.js"></script>
 
<script>
// initialize by constructing a named function...
// ...and add text processing plugin:
var chatWindow = new Bubbles(document.getElementById("buddy-bot"), "chatWindow", {
  // the one that we care about is inputCallbackFn()
  // this function returns an object with some data that we can process from user input
  // and understand the context of it

  // this is an example function that matches the text user typed to one of the answer bubbles
  // this function does no natural language processing
  // this is where you may want to connect this script to NLC backend.
  inputCallbackFn: function(o) {
    get_response(o.input)
      .then(data => {
        let response = data.response

        // do this if answer not found
        var miss = function() {
          chatWindow.talk(
            {
              "i-dont-get-it": {
                says: [
                  "I cannot answer that question currently, hopefully I can reply soon!"
                ],
                reply:[{
                  question: "Start Over",
                  answer: "ice"
                }]
              }
            },
            "i-dont-get-it"
          )
        }

        // do this if answer found
        var match = function() {
          chatWindow.talk(
            {
              "i-get-it": {
                says: [response, "Was that helpful?"],
                reply:[
                  {
                    question: "Yes",
                    answer: "yes"
                  }, 
                  {
                    question: "No",
                    answer: "no"
                  }
                ]
              }
            },
            "i-get-it"
          )
        }

        // if no answer is found, an empty string will be returned
        response === '' ? miss() : match()
      })   
  }
}) // done setting up chat-bubble

// conversation object
var convo = {
  ice: {
    says: ["Hello! Welcome to Buddy Bot.", "Please click one of the following replies, or chat below."],
    reply: [
      {
        question: "What is Buddy Bot?",
        answer: "about"
      },
      {
        question: "Where is your FAQ?",
        answer: "faq"
      }
    ]
  },
  about: {
    says: ["Buddy Bot is a chatbot designed to answer all of your programming needs.", "Please type your question below, and I'll be sure to answer."],
    reply: [
      {
        question: "Where is your FAQ?",
        answer: "faq"
      }
    ]
  },
  faq: {
    says: ["Our FAQ is located at the top of the page!", "If you have any more questions, you can type them below."],
    reply: [
      {
        question: "What is Buddy Bot?",
        answer: "about"
      }
    ]
  },
  yes: {
    says: ["Wonderful! I'm glad I could help."],
    reply: [
      {
        question: "I have another question",
        answer: "startOver"
      }
    ] 
  },
  no: {
    says: ["I'm sorry I couldn't find the right answer for you."],
    reply: [
      {
        question: "I would like to try again",
        answer: "startOver"
      }
    ] 
  },
  startOver: {
    says: ["Enter your question in the chat box below."]
  }
}

// pass JSON to your function and you're done!
chatWindow.talk(convo)
</script>
</body>
